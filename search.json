[{"title":"《利玛窦的记忆宫殿》阅读笔记","url":"/post/a4723547.html","content":"《利玛窦的记忆宫殿》阅读笔记\n1\n一直以来就对利玛窦其人很感兴趣，很多人似乎有种固有的认知，即中国与西方之间是相互隔绝。然而，若仔细翻阅历史，便会发现中西之间的交流远比我们以为的早和深。\n阅读本书，不像是在读一本史学著作，而像是读一本小说。史景迁的写作手法就如同讲故事般，以独特的视角带读者同历史人物一道一同体会真实的历史事件。\n作者以神奇的记忆术为引线，以利玛窦记忆宫殿中的四个形象：两名相互搏斗的武士，一名来自西域的女子，执镰刀的农夫，怀抱圣婴的圣母，和利玛窦交给程大约在《程氏墨苑》中刊刻的四幅图画为章节，带读者走入利玛窦的精神世界，了解他的生平。\n所谓记忆术，即在脑海中建构一座记忆宫殿，在其中为希望记住的东西给予一个形象，再为其分配一个适当的位置。利玛窦曾用汉语写过一本《西国记法》，希望借记忆术的功效吸引渴望考取功名的士子们，从而推进传教事业。虽然利玛窦本人多次在中国人面前展示他惊人的记忆力，然而似乎并没有人能练成这神奇的记忆术。\n利玛窦于 1582 年 8 月 7 日抵达澳门，先是在澳门努力学习中文。他脱下洋装，换上汉服，同时学习两种近代汉语——近代南京官话和近代粤语广府话，阅读大量中文书籍。而后辗转广州，肇庆，韶州，南昌，南京，北京，最终在 1610 年 5 月 11 日于北京去世。\n利玛窦在中国的生活和传教事业历经波折，经历过普通民众的围观，嘲弄，甚至冲突，为此扭伤了他的脚踝，在他剩下的十八年生命里，一旦要走远路，便伤痛缠身，只能跛脚前行；遗失圣书经文的痛苦；挚友与同事的死亡。\n\n利玛窦告诉弟弟奥拉吉奥，中国人总是对他的满头白发表示惊异，并奇怪为什么他年纪不大却看起来如此苍老。他补充说：“他们正是我白发苍苍的原因。”在 1595 年 8 月写给他的澳门上司——葡萄牙人孟三德神父的信中，利玛窦说，上帝选中了他，赐予他十二年含辛茹苦、饱受屈辱的生活。\n\n利玛窦不仅是一位虔诚的耶稣会士，在自然科学领域也涉猎颇深，撰写《乾坤体义》，介绍托勒密和亚里士多德的学说，绘制世界地图《坤舆万国全图》，和徐光启等人翻译欧几里得《几何原本》。\n2\n读这本书的时候，时常会有一种心灵的震撼，一个人漂洋过海，来到异国他乡，一片完全未知，语言文化不通的领域，凭着理想和信念想要融入这个社会。为此他学习汉语，穿着汉服，留起长发，打扮的像一个中国儒生，历经无数肉体和精神的折磨，依旧不夺其志，这是一种怎样强大的精神意志啊。\n\n1583年，利玛窦知道，在中国文化之外继续旁观已经变得十分奢侈。他剃掉须发，穿上袈裟，化身中国僧侣；此后十年间，他又蓄起胡子，穿上儒衫，打入热衷科举的士大夫群体。他始终认为，要开启文化上的交流，就应该“做中国人中间的中国人”。然而，无论如何努力，他想要面见的万历皇帝却始终拒绝见他。\n在人生的终点回望，利玛窦觉得自己茫然无着，不知身在何处，却早已难以返身。他不会知道，他的这些切身尝试，早已铺陈开十六世纪之后数百年中西文明交汇的壮阔图景。\n或许一切事情在肇始之初，都渺小微弱，无论事中人还是旁观者都无法说服自己，它将来能成就如此宏大的局面。\n\n3\n觉得这两章写得很好，摘抄上来以做纪念。\n第九章 宫门之内\n利玛窦脚穿绣花鞋，站在记忆宫殿的门口，许久以前，他从窗口跳出来，伤了一只脚，如今还隐隐作痛。\n他的思绪飘荡，跨越时空。眼前展现的是微微闪光的宫墙和立柱，是廊檐和雕饰精美的大门，在那后边，储放着许多记忆形象，那一切都来自阅读、经历，还有他那坚定的信仰。\n他看到一个人，那是大太监马堂，马堂暴怒异常，手中紧握着木刻的十字架，基督被钉在那十字架之上，汩汩淌血；他听见风声呼啸，那是赣江之上，狂风肆虐，前船的人们大喊示警，可惜船只倾覆，他和若望·巴达拉斯都掉入水中；他闻到焚香气味，那是在句容那漂亮的大花园里，他将一幅三联圣像画放在庙里的神龛上，周围点起香来，心中默祷；他品尝家常饭菜，那是肇庆城外的乡间，贫苦的农夫们拿来招待他的；他感到了面贴面的温情，那是临终前的石方西神父，双臂紧紧围抱住他的脖颈，两人泪流满面。\n在这片未知的地域，利玛窦已经走得太远，远超他的预料。他有时茫然无着，不知自己是否应该返回，自己是否还能返回。一次他写信给少年时的学友弗利加蒂，引用了维吉尔的诗句，“下往地狱的道路易行，但仍得返身原路踏上天国”。这句诗出自《埃涅阿斯纪》的第六卷，利玛窦和弗利加蒂多年前一道学习这诗篇，童年时他反复吟诵。但那一刻他匆忙间，只凭记忆引述，缩减了原文：\n\n    下往地狱的道路易行，\n  \t黑暗冥府的大门昼夜敞开。\n    但要返身原路登上天国，\n    其路险阻，多费辛劳。\n\n当时埃涅阿斯请求下入冥界，去寻找他死去的父亲，而女先知库迈的西比尔就这样劝告他。\n在利玛窦的画中，诸色人物都品味着命运的尖厉：使徒彼得在波涛中挣扎，两位门徒在前往以马忤斯途中停步，而所多玛的人们则跌倒在地，眼盲不能视物。在记忆宫殿的会客大厅，几个形象各安其位，两名在搏斗的武士，“回回”妇女，还有代表着姓氏“利”的农夫。\n“这样的事很常见，”利玛窦写道，“生活在后世的人们，往往无法了解前时代的伟大事业或行动如何起源。我时常揣思，这是缘于何故，发现只能如此解释：一切事情（包括那些最后取得极大成功的）在肇始之初，是那样微弱渺小，人们自己都无法说服自己相信，它将在将来成就如此宏大之局面。”\n他立在门口，身躯高大，留浓重的胡须，身着紫色镶蓝边的丝质长袍。记忆宫殿内寂静无声。在他身后有两名妇女，每位怀中都抱着一个婴孩。其中一位身着华美无比的绣花长裙，头肩部披着一块飘动的头巾，手持着一枝玫瑰。另一位丫鬟打扮，衣装朴素，头梳左右两个发髻，既示以年幼，又表面其仆女的身份。\n“尽管我还年轻，”利玛窦有次写信给马菲伊——他的友人，研究基督宗教扩张编年史的学者——说道，“我已经有了一些老年人的习性，总是喜欢称颂过去的时光。”\n两个婴孩也看着他。一个举起小小的右手，对天祈祷；另一个张开双臂，像在玩耍。四周很平静，但远处传来低沉的杂音，那是北京城街市的喧嚣。\n他关上了那扇门。\n译后记\n翻译史景迁先生的《利玛窦的记忆宫殿》，本身就是一次旅行。四百多年前利玛窦梯航远来，踏上东方土地，十几年间行旅中华万里河山。如今译者坐于灯下，但意念穿梭时空，温暖的山城马切拉塔、狂风肆虐的印度洋、南国旖旎、北海冰封，一幕幕闪现，这都有赖于史景迁先生笔下的魔力。作者以“记忆术”为引线，牵出的是一整幅十六、十七世纪东西方交流的宏阔图景。精彩的历史叙述，已能模糊“真实”与“想象”的界线，加之利玛窦记忆术本身具有的神奇色彩，使这部著作愈发显得亦真亦幻、动人心魄。\n几个世纪回转，当年种种，言辞交锋、挣扎与痛苦，仿佛都已散入历史的烟尘，但记忆本身——即使不凭借记忆术——却不会轻易泯灭。不分东海西海，人类对于恒久记忆的兴趣，几百年来并没有改变多少。若干年前，香港无线电视台（TVB）开播电视剧《读心神探》，出现在剧中桌头的一本《记忆宫殿》，又激起许多观众对西方记忆秘术的追捧。此中热闹，无论是利玛窦神父，还是史景迁先生，恐怕都无法料想。\n","categories":["阅读笔记","《利玛窦的记忆宫殿》"],"tags":["阅读"]},{"title":"《水流云在：我的西南联大岁月》阅读笔记","url":"/post/2bb93c7b.html","content":"《水流云在：我的西南联大岁月》阅读笔记\n本书是汪曾祺的散文集，以人民文学出版社《汪曾祺全集》散文卷为底本，主要以对大学青春岁月的回忆为主体。2025 年上半年购于广州购书中心天河店，具体日期记不太清了。\n师恩母爱 ——怀念王文英老师\n在读到 “师恩母爱 ——怀念王文英老师” 这一章的这一段时，颇为感动， 泪难自禁。\n\n1981 年秋，我应邀回阔别多年的家乡讲学，带了一点北京的果脯去看王先生和张先生，并给他们各送了一首在招待所急就的诗。给王先生的一首不文不白，毫无雕饰。第二天张先生带了两瓶酒到招待所来看我，我说哪有老师来看学生的道理，还带了酒！张先生说，是王先生一定要他送来的。说王先生看了我的诗，哭了一晚上。这首诗全诗是：\n小孩子乖乖，把门儿开开，歌声犹在，耳边徘徊。我今亦老矣，白髭盈腮，念一生美育，从此培栽，师恩母爱，岂能忘怀！愿吾师康健，长寿无灾。\n张先生说，王先生对他说：“我教那么多学生，长大了，还没有一个来看过我的！”王先生指着收“师恩母爱，岂能忘怀”对张先生收：“他进幼稚园的时候还戴着他妈妈的孝！”我这才知道王先生为什么对我特别关心，特别喜爱。张先生反复念了这两句，连说：“师恩母爱！师恩母爱！”\n\n“我今亦老矣，白髭盈腮，念一生美育，从此培栽，师恩母爱，岂能忘怀！”\n觅我游踪五十年\n\n将去云南，临行前的晚上，写了三首旧体诗。怕到了那里，有朋友叫写字，临时想不出合适词句。一九八七年去云南，一路写了不少字，平地抠饼，现想词儿，深以为苦。其中一首是：\n羁旅天南久未还，故乡无此好湖山。长堤柳色浓如许，觅我游踪五十年。\n\n","categories":["阅读笔记","《水流云在：我的西南联大岁月》"],"tags":["阅读","汪曾祺"]},{"title":"《酉阳杂俎》阅读笔记","url":"/post/d2b7ae7b.html","content":"《酉阳杂俎》阅读笔记\n之前在知乎上偶然间刷到了一篇关于酉阳杂俎的文章，觉得很是有趣，趁着去广州购书中心的机会便买了下来。本身内容繁杂，长短不一，慢慢读吧。\n作者简介\n本书作者段成式（803？——863），字柯古，祖籍临淄。段成式出身望族。其六世祖段志玄（598——642）是唐朝开国元勋，官至右卫大将军，封褒国公，为凌烟阁二十四功臣之一，陪葬昭陵。其父段文昌（773——835）为中唐名臣，穆宗时曾为中书侍郎、同中书门下平章事，文宗时进封邹平郡公，历镇淮南、荆南、剑南西川。其母则是中唐名相武元衡之女。\n段文昌于唐德宗贞元十五年（799）入剑南西川节度使韦皋幕府。段成式即出生于成都，青少年时随父侍宦，辗转于长安和成都，江东和西蜀之间。\n","categories":["阅读","《酉阳杂俎》"],"tags":["阅读","古文"]},{"title":"九月十四日夜行珠江畔","url":"/post/7f55bce6.html","content":"2025-9-14 晚\n夜行珠江畔，迎面江风拂。\n广州市天河区沿江西路\n\n    [{\"url\":\"https://img.angaiing.top/IMG_20250914_214727.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250921_211426.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250921_211932.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250921_211943.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250921_213219.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_202420.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_205945.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_211616.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_213224.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_213511.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_213545.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_213611.webp\",\"alt\":\"\",\"title\":\"\"},{\"url\":\"https://img.angaiing.top/IMG_20250914_214228.webp\",\"alt\":\"\",\"title\":\"\"}]\n  \n","categories":["散步"],"tags":["随手拍"]},{"title":"维护日志","url":"/post/ffcd24f1.html","content":"维护日志\n2025-10-13\n使用 hexo 和 butterfly 主题搭建了一个简单的静态个人博客，部署在 github pages，目前没有什么内容，希望以后能够坚持记录。\n2025-10-14\n稍微修改了一些设置，本来想将图片托管在图床上的，尝试使用 github+picgo，但效果不太行，尝试了下 cloudfare r2，等以后图片多起来了再试试吧。\n2025-10-15\n\n\n使用 cloudflare r2 + picgo 终于把图床搞好了，用的是picgo-plugin-cloudflare-r2这个插件，感谢作者！\n\n\n修改了一些 css 样式。在页脚底部添加了计时器。\n\n\n在 Vercel 和 MongoDB Atlas 上部署了 Twikoo 评论系统，具体教程在Twikoo 官方文档上写得很详细了，还可以参考以下两篇博客。\n\n\n【Vercel】Twikoo | 为你的 HEXO 加入评论系统\n\n\nHEXO 系列教程 | 在 Butterfly 主题中使用评论系统 twikoo\n\n\n\n\n2025-10-16\n\n在阿里云上 14 块钱买了一个一年的域名，添加了 Cloudflare DNS。\n在测试的时候发现国内访问太慢了，将网站从 github pages 迁移到了 netlify。结果突然发现 netlify 免费用户每月只有 300 积分，而每一次构建都要 15 积分……，最后还是迁移回 github pages。\n\n2025-10-17\n\n更换 CDN 为 jsdmirror，发现有些资源没有，换回了 jsdeliver。\n在 Vercel 上绑定了自己的域名，加快国内访问速度，具体可以参见这篇博客解决 Vercel 被墙导致 Twikoo 无法评论的问题：在 Vercel 添加子域名。\n\n2025-10-18\n\n添加了星空背景特效\n\n2025-10-19\n\n添加了萌 IPC 备案\n添加了 wizard 加载动画和 gulp 优化，具体可参见这篇博客hexo 博客 butterfly 主题安装及魔改笔记。\n\n","categories":["维护日志"],"tags":["本站相关","日志"]},{"title":"十月二十二日夜","url":"/post/c453eba7.html","content":"十月二十二日夜\n广州最近降温了，晚上总是寒风凛冽，吹得瑟缩起身体。寒意却总能激起我的思绪飞扬。\n大学不比中学，不求评优保研的话，没有那般大的课业和考试的压力，总有许多可自由支配的时间，做些自己想做的事，读些自己想读的书，写些自己想写的东西。闲下来也可以边听音乐边呆坐着做些不着边际的思考。没有名利物欲的追求，不必担惊受怕，平静的生活惬意得使人想永久沉溺于此。然而，人总要在社会上谋得一职位，若干年后，也终有毕业的一天，也终有工作的一日。那时的我又将怎样呢？我的志向在何方呢？不知道过去的我是否曾想到现在的我呢？\n人死后会有来世吗？意识会归于一片混沌还是又将出现呢？\n一想到此，我便不禁感慨人生的短暂，人类的渺小，宇宙的旷达，我所做的一切又有什么意义呢？\n我的躯体所能抵达的地方有限，然而我的思想却能横跨五大洲七大洋，越过地球，触摸宇宙的边界，追溯千年以前，想象千年以后。\n","categories":["杂谈"],"tags":["杂谈"]},{"title":"计组——汇编学习笔记","url":"/post/3a831366.html","content":"计组——汇编学习\n本文与著名的《深入理解计算机系统》（CS:APP）一书一样，汇编代码格式采用 AT&amp;T 格式。\nAT&amp;T 格式与 Intel 格式的不同\n\n\n\n特性\nAT&amp;T 格式\nIntel 格式\n\n\n\n\n操作数顺序\nop s,d源在左，目标在右\nop d,s目标在左，源在右\n\n\n寄存器表示\nmov %ebx,%eax寄存器名称前加 %\nmov ebx,eax不带前缀\n\n\n立即数表示\nmov $985,%eax立即数前加 $\nmov 985,%eax不带前缀\n\n\n主存地址表示\n(af996h)用小括号\n[af996h]用中括号\n\n\n读写长度表示\nmovl，movqb、w、l、q 分别表示 1、2、4、8 字节\nmov byte ptr [af996h],5在主存地址前说明读写长度\n\n\n主存偏移表示\n偏移(基址, 索引, 缩放)8(%ebp)(%eax, %ebx, 4)\n[基址 + 索引 * 缩放 + 偏移][ebp + 8][eax + ebx * 4]\n\n\n注释\n#\n;\n\n\n\n内存寻址\n在 AT&amp;T 语法中，一个完整的内存地址表达式格式为：\n$$\nD(R_b, R_i, S)\n$$\n计算出的内存地址为：\n$$\n\\text{内存地址} = D + R_b + R_i \\times S\n$$\n各部分的含义：\n\n$D$（Displacement / 偏移量）：一个常数值（例如 8、-12，或标签 my_var 的地址），类似于“基础”的门牌号。\n$R_b$（Base Register / 基址寄存器）：一个寄存器（例如 %ebp、%eax、%rbx），提供“动态的”基准地址，如函数栈帧的开始或数组的开头。\n$R_i$（Index Register / 索引寄存器）：另一个寄存器（例如 %ecx、%eax），通常用于存储“索引”值，如循环变量 i。\n$S$（Scale / 缩放因子）：一个固定的乘数，值必须是 1、2、4 或 8。它配合索引（$R_i$）使用。如果 $R_i$ 存储数组下标 i，而数组元素大小为 4 字节（int），则 $S$ 应为 4，这样 Ri * S 就等于 i * 4，即第 i 个元素的字节偏移。\n\n常用汇编指令\n数据传送指令\n这类指令负责在寄存器和内存之间移动数据，是所有程序的基础。\n1. mov（Move）\n\n\n功能：将源操作数的值复制到目标操作数。这是最常用、最重要的指令。\n\n\nAT&amp;T 格式：movl source, destination\n\n\n示例：\nmovl %eax, %ebx      # 将寄存器 %eax 的值复制到 %ebxmovl $10, %eax       # 将立即数 10 存入寄存器 %eaxmovl (%ebx), %eax    # 将 %ebx 寄存器指向的内存地址中的数据加载到 %eaxmovl %eax, -4(%rbp)  # 将 %eax 的值存入栈上地址为 %rbp-4 的位置\n\n\n2. lea（Load Effective Address）\n\n\n功能：计算源操作数（必须是内存地址）的有效地址，并将其加载到目标操作数（必须是寄存器）。它传送的是地址本身，而不是地址指向的数据。\n\n\nAT&amp;T 格式：leaq source_address, destination_register\n\n\n示例：\nleaq -8(%rbp), %rax  # 将内存地址 %rbp-8 这个地址值本身加载到 %rax 寄存器                     # 这条指令执行后，%rax 的值就是 %rbp 的值减 8\n\n\n说明：lea 指令非常灵活，常被用来进行不影响标志位的快速算术运算。\n\n\n3. push / pop（Push / Pop）\n\n\n功能：在栈上压入或弹出数据。栈是“后进先出”（LIFO）的数据结构，在函数调用中至关重要。\n\n\npush：将操作数压入栈顶，栈指针 %rsp 会减小。\n\n\npop：从栈顶弹出一个数据到操作数，栈指针 %rsp 会增大。\n\n\nAT&amp;T 格式：pushq source / popq destination\n\n\n示例：\npushq %rbx           # 将 %rbx 的值压入栈顶popq %rax            # 从栈顶弹出一个值到 %rax\n\n\n算术运算指令\n用于执行基本的数学计算。\n1. add / sub（Add / Subtract）\n\n\n功能：加法和减法。\n\n\nAT&amp;T 格式：addl source, destination（结果：destination = destination + source）\n\n\n示例：\naddl %eax, %ebx      # %ebx = %ebx + %eaxsubl $5, %ecx        # %ecx = %ecx - 5\n\n\n2. inc / dec（Increment / Decrement）\n\n\n功能：将操作数加一或减一。比 add 或 sub 更高效。\n\n\nAT&amp;T 格式：incl destination\n\n\n示例：\nincl %eax            # %eax = %eax + 1decq %rbx            # %rbx = %rbx - 1\n\n\n3. imul（Signed Multiply）\n\n\n功能：有符号整数乘法。\n\n\nAT&amp;T 格式：imull source, destination（结果：destination = destination * source）\n\n\n示例：\nimull %ebx, %eax     # %eax = %eax * %ebx\n\n\n4. idiv（Signed Divide）\n\n\n功能：有符号整数除法。这个指令比较特殊。\n\n\nAT&amp;T 格式：idivl divisor\n\n\n说明：idiv 会使用 %edx:%eax（一个 64 位数）作为被除数，除数是指令的操作数。商存储在 %eax 中，余数存储在 %edx 中。\n\n\n示例：\ncqto                 # 64 位模式下，将 %rax 符号扩展到 %rdx:%raxidivq %rbx           # (%rdx:%rax) / %rbx，商在 %rax，余数在 %rdx\n\n\n注意：在执行 32 位除法 idivl 前，通常需要 cdq 指令将 %eax 符号扩展到 %edx。\n\n\n逻辑与比较指令\n1. and / or / xor (Bitwise AND / OR / XOR)\n\n\n功能: 按位进行与、或、异或运算。\n\n\nAT&amp;T 格式: andl source, destination (结果: destination = destination &amp; source)\n\n\n示例:\nandl $0xf, %eax      # 清零 %eax 的高28位，保留低4位xorl %eax, %eax      # 一种将 %eax 清零的高效方法\n\n\n2. cmp（Compare）\n\n基本含义：cmp 指令对两个操作数执行一次“隐藏”的减法操作（Destination - Source），但不保存结果，仅根据结果设置 EFLAGS 寄存器中的标志位。\n语法格式：cmp Source, Destination\n影响的标志位：\n\nZF（Zero Flag - 零标志位）：如果相减结果为 0（即两个数相等），ZF 设为 1；否则为 0。\nSF（Sign Flag - 符号标志位）：如果结果为负数，SF 设为 1；否则为 0。\nCF（Carry Flag - 进位标志位）：用于无符号数比较。如果减法产生了借位（Destination &lt; Source），CF 设为 1。\nOF（Overflow Flag - 溢出标志位）：用于有符号数比较。如果减法导致有符号溢出，OF 设为 1。\n\n\n\n3. test（Test）\n\n基本含义：test 指令对两个操作数执行“隐藏”的按位与操作（Destination &amp; Source），但不保存结果，仅根据结果设置标志位。\n语法格式：test Source, Destination\n典型用途：检查一个数中的特定位是否为 1，或判断一个数是否为 0。例如，test %eax, %eax 可以快速判断 %eax 是否为 0。\n影响的标志位：\n\nZF（Zero Flag）：如果按位与的结果为 0，ZF 设为 1；否则为 0。\nSF（Sign Flag）：如果结果的最高位为 1（即负数），SF 设为 1；否则为 0。\nCF 和 OF 会被清零。\n\n\n\n控制流指令\n1. jmp（Unconditional Jump）- 无条件跳转\n\n基本含义：立即、无条件地将程序执行流转移到指定的标签（label）位置。\n语法格式：jmp label\n典型用途：用于 else 块执行后跳过 if 块，或构成循环。\n\n2. jcc（Conditional Jumps）- 条件跳转命令\n\n基本含义：这一系列命令会检查 EFLAGS 寄存器的特定标志位，如果满足条件，则跳转到指定标签；否则，顺序执行下一条指令。\n语法格式：j&lt;condition&gt; label\n\n常见条件跳转命令汇总\n\n\n\n命令\n描述（Jump if…）\n检查的标志位\n适用场景\n\n\n\n\n相等/零\n\n\n\n\n\nje\nEqual（相等）\nZF = 1\na == b\n\n\njne\nNot Equal（不相等）\nZF = 0\na != b\n\n\n有符号比较\n\n\n\n\n\njg\nGreater（大于）\nZF=0 and SF=OF\nsigned a &gt; b\n\n\njge\nGreater or Equal（大于等于）\nSF = OF\nsigned a &gt;= b\n\n\njl\nLess（小于）\nSF ≠ OF\nsigned a &lt; b\n\n\njle\nLess or Equal（小于等于）\nZF=1 or SF≠OF\nsigned a &lt;= b\n\n\n无符号比较\n\n\n\n\n\nja\nAbove（之上）\nCF=0 and ZF=0\nunsigned a &gt; b\n\n\njae\nAbove or Equal（之上或等于）\nCF = 0\nunsigned a &gt;= b\n\n\njb\nBelow（之下）\nCF = 1\nunsigned a &lt; b\n\n\njbe\nBelow or Equal（之下或等于）\nCF=1 or ZF=1\nunsigned a &lt;= b\n\n\n\n3. call / ret (Call / Return)\n\n\n功能: 用于函数（或子程序）的调用和返回。\n\n\ncall: 将下一条指令的地址压入栈中（作为返回地址），然后跳转到函数的起始地址。\n\n\nret: 从栈顶弹出返回地址，并跳转到该地址，从而返回到调用者。\n\n\n示例:\ncall my_function     # 调用名为 my_function 的函数# ... my_function 执行完毕后，会从这里继续执行my_function:    # ... 函数体 ...    ret              # 从函数返回\n\n\n4. cmovcc（Conditional Move，条件传送）指令\n\n基本含义：检查 EFLAGS 寄存器的特定标志位，如果满足条件，则执行 mov Source, Destination 操作。如果标志位不满足条件，该指令就变成一个空操作（NOP），不执行任何数据传送，Destination 的值保持不变。\n语法格式：cmov&lt;condition&gt; Source, Destination\n与条件跳转的对比：cmov 可以避免分支预测失败带来的性能损失，适用于简单的条件赋值。但如果条件分支的逻辑很复杂，使用条件跳转仍然是更好的选择。\n\n条件语句\n高级语言中的条件语句（如 if-else）是通过 cmp 或 test 指令与条件跳转指令（jcc）组合来实现的。其基本思想是：如果条件不满足，就跳过 if 块的代码。\n1. if 语句\nC 语言示例：\n// 假设 a 在 %eax, b 在 %ebxif (a &gt; b) &#123;    // body&#125;// next\n汇编实现：\n    cmp %ebx, %eax   # 比较 a 和 b (eax - ebx)    jle .L_end       # 如果 a &lt;= b (不满足 a &gt; b)，则跳转到结尾# if-body:    ...              # 条件满足时执行的代码.L_end:    ...              # 后续代码\n\n逻辑：先比较，然后使用与条件相反的跳转指令。如果 a &gt; b 的条件不成立（即 a &lt;= b），就跳过 if 的主体部分。\n\n2. if-else 语句\nC 语言示例：\n// 假设 a 在 %eax, b 在 %ebxif (a &gt; b) &#123;    // if-body&#125; else &#123;    // else-body&#125;// next\n汇编实现：\n    cmp %ebx, %eax   # 比较 a 和 b (eax - ebx)    jle .L_else      # 如果 a &lt;= b (不满足 a &gt; b)，则跳转到 else 块# if-body:    ...              # if 块的代码    jmp .L_end       # 执行完 if 块后，无条件跳转到结尾.L_else:# else-body:    ...              # else 块的代码.L_end:    ...              # 后续代码\n\n逻辑：\n\n比较 a 和 b。\n如果 if 的条件不满足，则跳转到 else 块（.L_else）。\n如果 if 的条件满足，则顺序执行 if 块的代码。\nif 块执行完毕后，必须用一个无条件跳转 jmp 来跳过 else 块，防止它被错误地执行。\n\n\n\n3. 使用 cmov 实现条件赋值\n对于简单的条件赋值，现代编译器倾向于使用 cmov 指令来代替条件跳转，以避免分支预测失败的性能开销。\nC 语言示例：\n// 计算 x 和 y 中的较大值int max(int x, int y) &#123;    return x &gt; y ? x : y;&#125;\n汇编实现（使用 cmov）：\n# x 在 %edi, y 在 %esi    movl %esi, %eax    # 先假设 y 是最大值，eax = y    cmpl %esi, %edi    # 比较 x 和 y    cmovg %edi, %eax   # 如果 x &gt; y (greater)，则将 x 的值赋给 eax    ret                # 返回 eax\n\n逻辑：这种实现方式没有跳转，代码是线性的。无论 x 和 y 的大小关系如何，执行的指令数量都是固定的，因此效率更高、更稳定。\n\n","categories":["学习笔记","计组","汇编"],"tags":["计组","汇编","学习"]}]